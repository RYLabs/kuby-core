(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{87:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return s})),t.d(n,"metadata",(function(){return i})),t.d(n,"rightToc",(function(){return c})),t.d(n,"default",(function(){return l}));var r=t(2),a=t(6),o=(t(0),t(92)),s={id:"customizing-kubernetes-resources",title:"Customizing Kubernetes Resources",sidebar_label:"Customizing Kubernetes Resources",slug:"/customizing-kubernetes-resources"},i={unversionedId:"customizing-kubernetes-resources",id:"customizing-kubernetes-resources",isDocsHomePage:!1,title:"Customizing Kubernetes Resources",description:'In Kubernetes, everything is a resource. Resources generally have a "kind" (eg. "ConfigMap", "Namespace", etc), and a unique name. Kubernetes resources are usually stored as flat .yml or .json files and applied via the Kubernetes CLI, kubectl (vocalized as "kube control", or "kube cuttle"). However, Kuby does things a little differently - resources are defined in Ruby code using the KubeDSL gem. Kuby defines around 10 resources for a standard Rails app, which are summarized below.',source:"@site/docs/customizing_kubernetes_resources.md",slug:"/customizing-kubernetes-resources",permalink:"/docs/customizing-kubernetes-resources",editUrl:"https://github.com/getkuby/kuby-core/edit/master/docs/docs/customizing_kubernetes_resources.md",version:"current",sidebar_label:"Customizing Kubernetes Resources",sidebar:"sidebar",previous:{title:"Customizing the Docker Build",permalink:"/docs/customizing-docker-build"},next:{title:"Environment Variables",permalink:"/docs/environment-variables"}},c=[],u={rightToc:c};function l(e){var n=e.components,t=Object(a.a)(e,["components"]);return Object(o.b)("wrapper",Object(r.a)({},u,t,{components:n,mdxType:"MDXLayout"}),Object(o.b)("p",null,'In Kubernetes, everything is a resource. Resources generally have a "kind" (eg. "ConfigMap", "Namespace", etc), and a unique name. Kubernetes resources are usually stored as flat .yml or .json files and applied via the Kubernetes CLI, ',Object(o.b)("inlineCode",{parentName:"p"},"kubectl"),' (vocalized as "kube control", or "kube cuttle"). However, Kuby does things a little differently - resources are defined in Ruby code using the ',Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/getkuby/kube-dsl"}),"KubeDSL gem"),". Kuby defines around 10 resources for a standard Rails app, which are summarized below."),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},Object(o.b)("strong",{parentName:"li"},"Namepace"),": A Kubernetes namespace inside which all other resources are defined."),Object(o.b)("li",{parentName:"ol"},Object(o.b)("strong",{parentName:"li"},"ServiceAccount"),": An account permitted to make changes inside the namespace."),Object(o.b)("li",{parentName:"ol"},Object(o.b)("strong",{parentName:"li"},"Service"),": Defines an HTTP interface to your app and defines which ports should be exposed."),Object(o.b)("li",{parentName:"ol"},Object(o.b)("strong",{parentName:"li"},"ConfigMaps"),": Contains configuration data your app needs to run, usually key/value pairs."),Object(o.b)("li",{parentName:"ol"},Object(o.b)("strong",{parentName:"li"},"Secrets"),': Contains app "secrets", i.e. sensitive configuration data like 3rd party API keys, passwords, etc. By default, this only contains the contents of ',Object(o.b)("inlineCode",{parentName:"li"},"RAILS_MASTER_KEY"),". A separate secret contains Docker image pull credentials."),Object(o.b)("li",{parentName:"ol"},Object(o.b)("strong",{parentName:"li"},"Deployment"),": Specifies how to deploy your app. Includes configuration for creating and migrating the database, as well as where to get the Docker image and how to safely restart the Rails server without dropping requests."),Object(o.b)("li",{parentName:"ol"},Object(o.b)("strong",{parentName:"li"},"Ingress"),": Defines how connections to your app will be made from the outside world.")),Object(o.b)("p",null,"Some functionality can be configured easily with flags or configuration options. For example, here's how to disable TLS for your Rails app (it's turned on by default):"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-ruby"}),"Kuby.define('my-app') do\n  environment(:production) do\n    kubernetes do\n      plugin :rails_app do\n        tls_enabled false\n      end\n    end\n  end\nend\n")),Object(o.b)("p",null,"You can also modify resources directly, since most of Kuby's resources are exposed publicly and are designed to be mutable. For example, here's how to change the name of your app's namespace object:"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-ruby"}),"Kuby.define('my-app') do\n  environment(:production) do\n    kubernetes do\n      plugin :rails_app do\n        namespace do\n          metadata do\n            name \"helloworld\"\n          end\n        end\n      end\n    end\n  end\nend\n")))}l.isMDXComponent=!0},92:function(e,n,t){"use strict";t.d(n,"a",(function(){return p})),t.d(n,"b",(function(){return m}));var r=t(0),a=t.n(r);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var u=a.a.createContext({}),l=function(e){var n=a.a.useContext(u),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},p=function(e){var n=l(e.components);return a.a.createElement(u.Provider,{value:n},e.children)},b={inlineCode:"code",wrapper:function(e){var n=e.children;return a.a.createElement(a.a.Fragment,{},n)}},d=a.a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,u=c(e,["components","mdxType","originalType","parentName"]),p=l(t),d=r,m=p["".concat(s,".").concat(d)]||p[d]||b[d]||o;return t?a.a.createElement(m,i(i({ref:n},u),{},{components:t})):a.a.createElement(m,i({ref:n},u))}));function m(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var o=t.length,s=new Array(o);s[0]=d;var i={};for(var c in n)hasOwnProperty.call(n,c)&&(i[c]=n[c]);i.originalType=e,i.mdxType="string"==typeof e?e:r,s[1]=i;for(var u=2;u<o;u++)s[u]=t[u];return a.a.createElement.apply(null,s)}return a.a.createElement.apply(null,t)}d.displayName="MDXCreateElement"}}]);