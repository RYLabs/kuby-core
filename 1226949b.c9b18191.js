(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{53:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return s})),n.d(t,"rightToc",(function(){return c})),n.d(t,"default",(function(){return u}));var a=n(2),r=n(6),o=(n(0),n(90)),i={id:"data-stores",title:"Managing Data Stores",sidebar_label:"Managing Data Stores",slug:"/data-stores"},s={unversionedId:"data-stores",id:"data-stores",isDocsHomePage:!1,title:"Managing Data Stores",description:"Kuby uses the excellent KubeDB project to stand up databases using Kubernetes. It does so by inspecting your Rails app's database configuration. In other words, without any additional configuration, Kuby will automatically create a database using the same engine and login credentials you've defined in config/database.yml.",source:"@site/docs/data-stores.md",slug:"/data-stores",permalink:"/docs/docs/data-stores",editUrl:"https://github.com/getkuby/kuby-docs/edit/master/docs/data-stores.md",version:"current",sidebar_label:"Managing Data Stores",sidebar:"sidebar",previous:{title:"Managing Secrets",permalink:"/docs/docs/managing-secrets"},next:{title:"TLS Certificates",permalink:"/docs/docs/tls-certificates"}},c=[{value:"Migrations",id:"migrations",children:[]},{value:"Increasing Storage",id:"increasing-storage",children:[]},{value:"Using a Managed Database",id:"using-a-managed-database",children:[]}],d={rightToc:c};function u(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(o.b)("wrapper",Object(a.a)({},d,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,"Kuby uses the excellent ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://kubedb.com/"}),"KubeDB")," project to stand up databases using Kubernetes. It does so by inspecting your Rails app's database configuration. In other words, without any additional configuration, Kuby will automatically create a database using the same engine and login credentials you've defined in config/database.yml."),Object(o.b)("h2",{id:"migrations"},"Migrations"),Object(o.b)("p",null,"Migrations are run automatically on every deploy."),Object(o.b)("h2",{id:"increasing-storage"},"Increasing Storage"),Object(o.b)("p",null,"Kuby will instruct your database engine to persist data using whatever form of block (i.e. permanent) storage your provider supports. By default, Kuby asks for 10gb of storage space. If you need more, try this:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ruby"}),"Kuby.define('my-app') do\n  environment(:production) do\n    kubernetes do\n      plugin :rails_app do\n        database do\n          storage '20Gi'\n        end\n      end\n    end\n  end\nend\n")),Object(o.b)("p",null,"If you've already deployed and started writing to your database, be careful when changing the amount of requested storage. Consult your provider's documentation for information regarding how to safely resize persistent volumes. Most providers can do so in-place and without requiring a restart or volume reattachment. Depending on what the provider does under the covers, changing the volume size can be a risky operation - check the docs first."),Object(o.b)("h2",{id:"using-a-managed-database"},"Using a Managed Database"),Object(o.b)("p",null,"KubeDB is a fantastic, production-grade offering, but if the thought of running a database in Kubernetes scares you, you're not alone. Many developers prefer to use a managed database hosted and maintained by a cloud provider. You can tell Kuby to not manage the database like so:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ruby"}),"Kuby.define('my-app') do\n  environment(:production) do\n    kubernetes do\n      plugin :rails_app do\n        manage_database false\n      end\n    end\n  end\nend\n")))}u.isMDXComponent=!0},90:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return g}));var a=n(0),r=n.n(a);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var d=r.a.createContext({}),u=function(e){var t=r.a.useContext(d),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},l=function(e){var t=u(e.components);return r.a.createElement(d.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},b=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,d=c(e,["components","mdxType","originalType","parentName"]),l=u(n),b=a,g=l["".concat(i,".").concat(b)]||l[b]||p[b]||o;return n?r.a.createElement(g,s(s({ref:t},d),{},{components:n})):r.a.createElement(g,s({ref:t},d))}));function g(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=b;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var d=2;d<o;d++)i[d]=n[d];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"}}]);